{% extends 'base.html' %}
{% block title %}Patient Dashboard{% endblock %}
{% block content %}
<h3>Registrar Dosis</h3>
<form method="post" class="mb-4">
  <div class="row">
    <div class="col">
      <select name="supply_id" class="form-select" required>
        <option value="">Seleccionar Medicamento</option>
        {% for s in supplies %}
          <option value="{{ s.id }}">{{ s.name }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col">
      <input type="text" name="dosage_type" class="form-control" placeholder="Ej: Cada 8 horas" required>
    </div>
    <div class="col">
      <input type="text" name="note" class="form-control" placeholder="Nota (opcional)">
    </div>
    <div class="col-auto">
      <button type="submit" class="btn btn-primary">Registrar</button>
    </div>
  </div>
</form>

<hr>
<h3>Historial de Dosis</h3>
<ul class="list-group">
  {% for h in history %}
    <li class="list-group-item">
      <strong>{{ h.timestamp.strftime('%Y-%m-%d %H:%M') }}</strong> – 
      {{ h.supply.name }} – 
      Dosis: {{ h.dosage_type }} 
      {% if h.note %}({{ h.note }}){% endif %}
      <br>
      <small>Próxima dosis: {{ h.next_dose_date.strftime('%Y-%m-%d %H:%M') }}</small>
    </li>
  {% endfor %}
</ul>
{% endblock %}